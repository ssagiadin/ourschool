<!DOCTYPE html>
<html lang="en" ng-app="teachers">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="Spyros Sagiadinos" >
	<link rel="icon" href="/favicon.ico">
	<title>Dashboard Template for Bootstrap</title>

	<!-- Bootstrap core CSS -->
	<link href="/css/bootstrap.min.css" rel="stylesheet">
	<link href="/css/flag-icon.min.css" rel="stylesheet">
   <link rel="stylesheet" type="text/css" href="/css/angular-awesome-slider.min.css">
	<!-- <link href="/css/ng-slider.min.css" rel="stylesheet" type="text/css" /> -->
	<!-- Custom styles for this template -->
	<link href="/css/teacher.css" rel="stylesheet">

	<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
	<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
	<script src="../../assets/js/ie-emulation-modes-warning.js"></script>

	<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
	<script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>

<body ng-controller="TeachersCtrl">
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" ng-click="isCollapsed = !isCollapsed">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="#">{{ i18n.literals.PROJECT }}</a>
		</div>
		<div collapse="isCollapsed">
			<ul class="nav navbar-nav navbar-right">
				<li><a href="#/dashboard" class="nav-sel">{{ i18n.literals.DASHBOARD }}</a></li>
				<li><a href="#/new" class="nav-sel">{{ i18n.literals.NEW_LESSON }}</a></li>
				<li class="dropdown" dropdown ng-show="lessons.length > 0">
					<a href class="dropdown-toggle" dropdown-toggle>{{ i18n.literals.LESSONS }} <span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li ng-repeat="lesson in lessons">
							<a href="/teachers/{{ teacher.id }}/lessons/{{ lesson.id }}">{{ lesson.descr }}</a>
						</li>
					</ul>
				</li>
				<li><a href="#">{{ i18n.literals.HELP }}</a></li>
				<li class="dropdown" dropdown>
					<a href class="dropdown-toggle" dropdown-toggle>{{ teacher.mail }} <span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li><a href="#">Profile</a></li>
						<li class="divider"></li>
						<li><a href="{! url|safe !}">Logout</a></li>
					</ul>
				</li>
				<li>
					<p class="navbar-text">
						<span class="flag-icon flag-icon-gr" ng-click="language='el'"></span>
						<span class="flag-icon flag-icon-gb" ng-click="language='gb'"></span>
					</p>
				</li>
			</ul>
<!--          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form> -->
		</div>
	</div>
</div>
<div class="container-fluid">
	<div class="row">
		<div class="col-sm-3 col-md-2 sidebar">
			<ul class="nav nav-sidebar">
				<li class="active"><a href="#/dashboard" data-ourschool-action="dashboard">{{ i18n.literals.DASHBOARD }}</a></li>
				<li><a href="new" data-ourschool-action="lessonNew">{{ i18n.literals.NEW_LESSON }}</a></li>
			</ul>
			<ul class="nav nav-sidebar" ng-show="lessons.length > 0">
				<li ng-repeat="lesson in lessons">
					<a href="/teachers/{{ teacher.id }}/lessons/{{ lesson.id }}">{{ lesson.descr }}</a>
					<span class="glyphicon glyphicon-remove text-danger pull-right" data-ourschool-action="lessonRemove"></span>
					<span class="glyphicon glyphicon-pencil text-success pull-right" data-ourschool-action="lessonEdit"></span>
				</li>
			</ul>
		</div>
		<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" ng-view></div>
<!-- Lesson -->

<!-- Lesson -->
	</div>
</div>

<!-- Dialogs -->
<!-- Question dialog placeholder (created by template) -->
	<div class="modal fade" id="question" tabindex="-1" role="dialog" aria-labelledby="questionLabel" aria-hidden="true">
	  <div class="modal-dialog">

	  </div>
	</div>
<!-- Confirmation dialog placeholder (created by template) -->
	<div class="modal fade" id="confirm" tabindex="-1" role="dialog" aria-labelledby="confirmLabel" aria-hidden="true">
	  <div class="modal-dialog modal-sm">

	  </div>
	</div>

<!-- Alerts -->
<div class="hidden alert alert-danger alert-dismissible" role="alert" id="error">
  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
  <strong>Warning!</strong> Better check yourself, you're not looking too good.
</div>

<!-- Templates -->    
	{% raw %}
	<script id="lessons-side-item-template" type="text/x-handlebars-template">
	<li>
		<a href="/teachers/{!teacher_id!}/lessons/{!id!}">{!descr!}
			<span class="glyphicon glyphicon-remove text-danger pull-right" data-ourschool-action="lessonRemove"></span>
			<span class="glyphicon glyphicon-pencil text-success pull-right" data-ourschool-action="lessonEdit"></span>
		</a>
	</li>
	</script>
	<script id="lessons-nav-template" type="text/x-handlebars-template">
	<li id="lessons-nav" class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/teachers/{!teacher_id!}/lessons/{!id!}" class="nav-sel">{!descr!}</a></li>
		</ul>
	</li>
	</script>
	<script id="multi-answer-template" type="text/x-handlebars-template">
	<div class="input-group">
		{!#over!}
		<span class="input-group-addon"><input type="checkbox" name="check"></span>
		{!/over!}
		<input type="text" name="answer{!no!}" class="form-control" {!#if answer!}value={!answer!}{!/if!}>
		<span class="input-group-addon"><input type="radio" name="correct" value="{!no!}" {!#if correct!}checked{!/if!}></span>
	</div>
	</script>
	<script id="question-template" type="text/x-handlebars-template">
	<tr>
		<td>{!no!}</td>
		{!#with question!}
			<td>{!qtext!}</td>
			<td>
			{!#multi!}
				<span class="glyphicon glyphicon-list"></span>
			{!else!}
				<span class="glyphicon glyphicon-font"></span>
			{!/multi!}
			</td>
			<td>
			{!#if link!}
				<span class="glyphicon glyphicon-film text-info qlink" data-ourschool-action="questionLink"></span>
			{!/if!}
			</td>
			<td>
				<span class="glyphicon glyphicon-pencil text-success qedit" data-ourschool-action="questionEdit"></span>
				<span class="glyphicon glyphicon-remove text-danger qremove" data-ourschool-action="questionRemove"></span>
			</td>
		{!/with!}
	</tr>
	</script>
   <script id="question-dialog-template" type="text/x-handlebars-template">
    <div class="modal-content">
      <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">
				<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
			</button>
        <h4 class="modal-title" id="questionLabel">{!info.action!} question</h4>
      </div>
      <div class="modal-body">
			<form role="form">
				<div class="form-group">
					<label for="qtext">Question</label>
					<textarea id="qtext" class="form-control" name="qtext" rows="2">{!#if qtext!}{!qtext!}{!/if!}</textarea>
				</div>
				<div class="form-group">
					<div class="btn-toolbar">
						<div class="btn-group" data-toggle="buttons">
							<label class="btn btn-primary {!#multi!}active{!/multi!}">
								<input type="radio" name="qtype" value="{! info.MULTI !}" {!#multi!}checked{!/multi!}>
								<span class="glyphicon glyphicon-list"></span>
							</label>
							<label class="btn btn-primary {!#single!}active{!/single!}">
								<input type="radio" name="qtype" value="{! info.SINGLE !}" {!#single!}checked{!/single!}>
								<span class="glyphicon glyphicon-font"></span>
							</label>
						</div>
						<div class="btn-group" data-toggle="buttons">
							<label class="btn btn-primary {!#if link!}active{!/if!}">
								<input type="checkbox" name="link" {!#if link!}checked{!/if!}>
								<span class="glyphicon glyphicon-paperclip"></span>
							</label>
						</div>
					</div>
				</div>
				<fieldset id="multi" class="{!#single!}hidden{!/single!}">
					<label>Answers </label>
					<span >
						<button type="button" id="add-multi" class="btn btn-primary btn-sm" >Add</button>				
						<button type="button" id="remove-multi" class="btn btn-warning btn-sm" disabled>Remove</button>
					</span>
					{!#multi_answers answers!}
						{!> answer!}
					{!/multi_answers!}
				</fieldset>
				<fieldset id="single" class="{!#multi!}hidden{!/multi!}">
					<label>Answer</label>
					<textarea class="form-control" name="answer" rows="3">{!answers.[0]!}</textarea>
				</fieldset>
			</form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="save-q">Save changes</button>
      </div>
    </div>   
   </script>
   <script id="confirmation-dialog-template" type="text/x-handlebars-template">
    <div class="modal-content">
      <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">
				<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
			</button>
        <h4 class="modal-title">
        {!#if title!}
        {!title!}
        {!else!}
        Confirmation wanted
		  {!/if!}        
        </h4>
      </div>
      <div class="modal-body">
		{!#if msg!}
		{!msg!}
		{!else!}
		Do you want  to delete this item?
		{!/if!}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" id="conf-accept" data-ourschool-action="confAccept">Delete</button>
      </div>
    </div>   
   </script>
	{% endraw %}

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
	<script src="/js/angular.min.js"></script>
	<script src="/js/angular-route.min.js"></script>
	<script src="/js/angular-touch.min.js"></script>
	<script src="/js/ui-bootstrap-tpls-0.12.0.min.js"></script>
   <script type="text/javascript" src="/js/angular-awesome-slider.min.js"></script>
<!--	<script src="/js/ng-slider.min.js"></script> -->
<!--    <script src="/js/docs.min.js"></script>-->
	<script src="/js/controllers.js"></script>
	<script src="/js/teacher.js"></script>
<!--    <script src="/js/handlebars.js"></script>-->
    <script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      var YT_Api = false;
      function onYouTubeIframeAPIReady() {
      	YT_Api = true;
			player = new YT.Player('player', {
				playerVars: { 'controls': 0 },
				events: {
					'onReady': onPlayerReady,
					'onStateChange': onPlayerStateChange,
					'onError': onPlayerError
				}
			});
      }
      
      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
//        alert("That's cool");
      }

		function onPlayerStateChange( event ) {
			if ( event.data == YT.PlayerState.PLAYING ) {
				if ( initialLd ) {
					videoDuration = player.getDuration();
					initialLd = false;
					$( '#slider-wrap' )
						.find( '*' )
							.remove()
						.end()
						.append( '<input type="text" id="slider">' );
					$slider = $( '#slider' );
					$slider.simpleSlider( { theme: 'volume', highlight: true, range: [ 0, videoDuration ] } );
					$( "#pbrange input[name=pbstart]" ).val( 0 );
					$( "#pbrange input[name=pbstop]" ).val( Math.floor( videoDuration ) );
				}
				sliderUpdateID = setInterval( sliderUpdate, 2000 );
			} else if ( event.data == YT.PlayerState.PAUSED ) {
				clearInterval( sliderUpdateID );
			}
		}
		
		function onPlayerError( event ) {
			$( '#lesson input[name=videourl]' ).parent().addClass( 'has-error' );
//			$( '#error' ).toggleClass( 'hidden' );
//			alert('Error');
		}
      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
/*      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          setTimeout(stopVideo, 6000);
          done = true;
        }
      }*/
      function stopVideo() {
        player.stopVideo();
      }
    </script>
    <script type="text/javascript" >
		var MULTI = {! MULTI !};
		var SINGLE = {! SINGLE !};
		var teacher = {
			id: '{! teacher_id !}',
			mail: '{! teacher !}',
			lessons: [
			{% for lesson in lessons %}
				{ descr: '{! lesson.descr|e !}', id:  '{! lesson.id !}' },
			{% endfor %}	
			]
		};
		var teacher_id = '{! teacher_id !}';
	 </script>
  </body>
</html>
